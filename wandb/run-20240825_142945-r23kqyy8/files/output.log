/home2/shreyu/.pyenv/versions/ltd/lib/python3.7/site-packages/albumentations/augmentations/transforms.py:1286: FutureWarning: RandomContrast has been deprecated. Please use RandomBrightnessContrast
  FutureWarning,
/home2/shreyu/.pyenv/versions/ltd/lib/python3.7/site-packages/albumentations/augmentations/transforms.py:1260: FutureWarning: This class has been deprecated. Please use RandomBrightnessContrast
  FutureWarning,
2024-08-25 14:29:55.532 | INFO     | tools.create_dataset:create_dataset:49 - Datasets prepared
2024-08-25 14:29:55.534 | INFO     | tools.create_dataset:create_dataset:77 - Dataloaders created
2024-08-25 14:29:59.985 | INFO     | __main__:<module>:142 - gpus: 4
/home2/shreyu/.pyenv/versions/ltd/lib/python3.7/site-packages/lightning_fabric/plugins/environments/slurm.py:168: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 main.py configs/config.yaml ...
  category=PossibleUserWarning,
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
2024-08-25 14:30:00.023 | INFO     | __main__:<module>:153 - Beginning to train
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
checkpoint_path /ssd_scratch/cvit/shreyu/datasets/ptx-textseg-dataset/output_dir/checkpoints
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------
2024-08-25 14:30:23,186 - Added key: store_based_barrier_key:1 to store for rank: 0
2024-08-25 14:30:23,187 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
  | Name  | Type | Params
-------------------------------
0 | model | UNET | 31.0 M
-------------------------------
31.0 M    Trainable params
0         Non-trainable params
31.0 M    Total params
124.146   Total estimated model params size (MB)

Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]
/home2/shreyu/honors/text_segmentation/Locate-then-Delineate/utils/generalized_dice_loss.py:121: UserWarning: single channel prediction, `include_background=False` ignored.
  warnings.warn("single channel prediction, `include_background=False` ignored.")
/home2/shreyu/.pyenv/versions/ltd/lib/python3.7/site-packages/pytorch_lightning/utilities/data.py:84: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 8. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.






































































































Epoch 0:  75%|███████▌  | 360/480 [04:15<01:25,  1.41it/s, loss=0.388, v_num=qyy8]


























































































































Epoch 1:  75%|███████▌  | 360/480 [04:12<01:24,  1.42it/s, loss=0.194, v_num=qyy8]
















































































































Epoch 2:  75%|███████▌  | 360/480 [04:18<01:26,  1.39it/s, loss=0.148, v_num=qyy8]

































































































































Epoch 3:  75%|███████▌  | 360/480 [04:16<01:25,  1.40it/s, loss=0.165, v_num=qyy8]

































































































































Epoch 4:  75%|███████▌  | 360/480 [04:33<01:31,  1.32it/s, loss=0.155, v_num=qyy8]
































































































































Epoch 5:  75%|███████▌  | 360/480 [04:13<01:24,  1.42it/s, loss=0.132, v_num=qyy8]























































































































Epoch 6:  75%|███████▌  | 360/480 [04:16<01:25,  1.40it/s, loss=0.135, v_num=qyy8]


































































































Epoch 7:  75%|███████▌  | 360/480 [04:18<01:26,  1.39it/s, loss=0.131, v_num=qyy8]




























































































































Epoch 8:  75%|███████▌  | 360/480 [04:18<01:26,  1.39it/s, loss=0.078, v_num=qyy8]










































































































Epoch 9:  75%|███████▌  | 360/480 [04:15<01:25,  1.41it/s, loss=0.101, v_num=qyy8]














































































































Epoch 10:  75%|███████▌  | 360/480 [04:15<01:25,  1.41it/s, loss=0.0974, v_num=qyy8]




































































































































Epoch 11:  75%|███████▌  | 360/480 [04:16<01:25,  1.40it/s, loss=0.0988, v_num=qyy8]


























































































































Epoch 12:  75%|███████▌  | 360/480 [04:14<01:24,  1.42it/s, loss=0.0644, v_num=qyy8]
















































































































Epoch 13:  75%|███████▌  | 360/480 [04:18<01:26,  1.39it/s, loss=0.0775, v_num=qyy8]





































































































































Epoch 14:  75%|███████▌  | 360/480 [04:16<01:25,  1.41it/s, loss=0.063, v_num=qyy8]








































































































Epoch 15:  75%|███████▌  | 360/480 [04:12<01:24,  1.43it/s, loss=0.0605, v_num=qyy8]




























































































































Epoch 16:  75%|███████▌  | 360/480 [04:36<01:32,  1.30it/s, loss=0.0387, v_num=qyy8]














































































































Epoch 17:  75%|███████▌  | 360/480 [04:16<01:25,  1.40it/s, loss=0.0756, v_num=qyy8]
































































































































Epoch 18:  75%|███████▌  | 360/480 [04:35<01:31,  1.31it/s, loss=0.0576, v_num=qyy8]













































































































Epoch 19:  75%|███████▌  | 360/480 [04:13<01:24,  1.42it/s, loss=0.107, v_num=qyy8]














































































































































Epoch 20:  75%|███████▌  | 360/480 [04:17<01:25,  1.40it/s, loss=0.0551, v_num=qyy8]











































































































































Epoch 21:  75%|███████▌  | 360/480 [04:19<01:26,  1.39it/s, loss=0.0875, v_num=qyy8]






































































































































Epoch 22:  75%|███████▌  | 360/480 [04:43<01:34,  1.27it/s, loss=0.0639, v_num=qyy8]























































































































Epoch 23:  75%|███████▌  | 360/480 [04:24<01:28,  1.36it/s, loss=0.102, v_num=qyy8]






























































































































Epoch 24:  75%|███████▌  | 360/480 [04:39<01:33,  1.29it/s, loss=0.0718, v_num=qyy8]


























































































































Epoch 25:  75%|███████▌  | 360/480 [04:20<01:26,  1.38it/s, loss=0.0514, v_num=qyy8]





























































































































Epoch 26:  75%|███████▌  | 360/480 [04:16<01:25,  1.40it/s, loss=0.062, v_num=qyy8]























































































































Epoch 27:  75%|███████▌  | 360/480 [04:27<01:29,  1.34it/s, loss=0.0348, v_num=qyy8]














































































































Epoch 28:  75%|███████▌  | 360/480 [04:28<01:29,  1.34it/s, loss=0.0524, v_num=qyy8]



























































































































Epoch 29:  75%|███████▌  | 360/480 [04:29<01:29,  1.33it/s, loss=0.0656, v_num=qyy8]



































































































































Epoch 30:  75%|███████▌  | 360/480 [04:17<01:25,  1.40it/s, loss=0.0451, v_num=qyy8]
























































































































Epoch 31:  75%|███████▌  | 360/480 [04:13<01:24,  1.42it/s, loss=0.0674, v_num=qyy8]


































































































































Epoch 32:  75%|███████▌  | 360/480 [04:49<01:36,  1.24it/s, loss=0.0512, v_num=qyy8]













































































































































Epoch 33:  75%|███████▌  | 360/480 [04:16<01:25,  1.41it/s, loss=0.0585, v_num=qyy8]





































































































































Epoch 34:  75%|███████▌  | 360/480 [04:25<01:28,  1.36it/s, loss=0.0428, v_num=qyy8]

































































































































Epoch 35:  75%|███████▌  | 360/480 [04:18<01:26,  1.39it/s, loss=0.0511, v_num=qyy8]






















































































































Epoch 36:  75%|███████▌  | 360/480 [04:13<01:24,  1.42it/s, loss=0.0542, v_num=qyy8]




































































































































Epoch 37:  75%|███████▌  | 360/480 [04:39<01:33,  1.29it/s, loss=0.0371, v_num=qyy8]


























































































































Epoch 38:  75%|███████▌  | 360/480 [04:36<01:32,  1.30it/s, loss=0.0541, v_num=qyy8]




















































































































































Epoch 39:  75%|███████▌  | 360/480 [04:30<01:30,  1.33it/s, loss=0.0666, v_num=qyy8]


































































































Epoch 40:  75%|███████▌  | 360/480 [04:40<01:33,  1.28it/s, loss=0.0708, v_num=qyy8]












































































































Epoch 41:  75%|███████▌  | 360/480 [04:38<01:32,  1.29it/s, loss=0.0742, v_num=qyy8]





































































































































Epoch 42:  75%|███████▌  | 360/480 [04:18<01:26,  1.39it/s, loss=0.0572, v_num=qyy8]





















































































































Epoch 43:  75%|███████▌  | 360/480 [04:14<01:24,  1.42it/s, loss=0.0482, v_num=qyy8]

















































































































Epoch 44:  75%|███████▌  | 360/480 [04:21<01:27,  1.37it/s, loss=0.0687, v_num=qyy8]





























































































































Epoch 45:  75%|███████▌  | 360/480 [04:14<01:24,  1.41it/s, loss=0.0605, v_num=qyy8]




































































































































Epoch 46:  75%|███████▌  | 360/480 [04:26<01:28,  1.35it/s, loss=0.0534, v_num=qyy8]




























































































































Epoch 47:  75%|███████▌  | 360/480 [04:13<01:24,  1.42it/s, loss=0.0514, v_num=qyy8]























































































































Epoch 48:  75%|███████▌  | 360/480 [04:17<01:25,  1.40it/s, loss=0.0596, v_num=qyy8]



































































































































Epoch 49:  75%|███████▌  | 360/480 [04:15<01:25,  1.41it/s, loss=0.059, v_num=qyy8]

































































































































Epoch 50:  75%|███████▌  | 360/480 [04:20<01:26,  1.38it/s, loss=0.0584, v_num=qyy8]


















































































































Epoch 51:  75%|███████▌  | 360/480 [04:17<01:25,  1.40it/s, loss=0.0722, v_num=qyy8]














































































































































Epoch 52:  75%|███████▌  | 360/480 [04:35<01:31,  1.31it/s, loss=0.0596, v_num=qyy8]















































































































































Epoch 53:  75%|███████▌  | 360/480 [04:32<01:30,  1.32it/s, loss=0.0461, v_num=qyy8]

































































































































Epoch 54:  75%|███████▌  | 360/480 [04:34<01:31,  1.31it/s, loss=0.0419, v_num=qyy8]








































































































































Epoch 55:  75%|███████▌  | 360/480 [04:29<01:29,  1.34it/s, loss=0.042, v_num=qyy8]
















































































































































Epoch 56:  75%|███████▌  | 360/480 [04:33<01:31,  1.31it/s, loss=0.0495, v_num=qyy8]


















































































































































Epoch 57:  75%|███████▌  | 360/480 [04:28<01:29,  1.34it/s, loss=0.0434, v_num=qyy8]




























































































































Epoch 58:  75%|███████▌  | 360/480 [04:12<01:24,  1.43it/s, loss=0.0521, v_num=qyy8]



































































































































Epoch 59:  75%|███████▌  | 360/480 [04:13<01:24,  1.42it/s, loss=0.0333, v_num=qyy8]


































































































































Epoch 60:  75%|███████▌  | 360/480 [04:13<01:24,  1.42it/s, loss=0.0503, v_num=qyy8]























































































































Epoch 61:  75%|███████▌  | 360/480 [04:10<01:23,  1.44it/s, loss=0.0531, v_num=qyy8]







































































































Epoch 62:  75%|███████▌  | 360/480 [04:14<01:24,  1.42it/s, loss=0.0518, v_num=qyy8]



















































































































Epoch 63:  75%|███████▌  | 360/480 [04:12<01:24,  1.42it/s, loss=0.0292, v_num=qyy8]
















































































































Epoch 64:  75%|███████▌  | 360/480 [04:11<01:23,  1.43it/s, loss=0.0186, v_num=qyy8]
















































































































Epoch 65:  75%|███████▌  | 360/480 [04:21<01:27,  1.38it/s, loss=0.0613, v_num=qyy8]


























































































































Epoch 66:  75%|███████▌  | 360/480 [04:17<01:25,  1.40it/s, loss=0.0571, v_num=qyy8]

































































































































Epoch 67:  75%|███████▌  | 360/480 [04:31<01:30,  1.33it/s, loss=0.0373, v_num=qyy8]































































































































Epoch 68:  75%|███████▌  | 360/480 [04:35<01:31,  1.31it/s, loss=0.0617, v_num=qyy8]





















































































































Epoch 69:  75%|███████▌  | 360/480 [04:38<01:32,  1.29it/s, loss=0.0568, v_num=qyy8]






























































































































Epoch 70:  75%|███████▌  | 360/480 [04:32<01:30,  1.32it/s, loss=0.0446, v_num=qyy8]





































































































































Epoch 71:  75%|███████▌  | 360/480 [04:32<01:30,  1.32it/s, loss=0.0352, v_num=qyy8]




















































































































Epoch 72:  75%|███████▌  | 360/480 [04:35<01:31,  1.31it/s, loss=0.0318, v_num=qyy8]




































































































































Epoch 73:  75%|███████▌  | 360/480 [04:33<01:31,  1.32it/s, loss=0.0404, v_num=qyy8]















































































































Epoch 74:  75%|███████▌  | 360/480 [04:15<01:25,  1.41it/s, loss=0.0476, v_num=qyy8]

























































































































Epoch 75:  75%|███████▌  | 360/480 [04:13<01:24,  1.42it/s, loss=0.0377, v_num=qyy8]


















































































































Epoch 76:  75%|███████▌  | 360/480 [04:14<01:24,  1.41it/s, loss=0.0449, v_num=qyy8]






















































































































Epoch 77:  75%|███████▌  | 360/480 [04:14<01:24,  1.42it/s, loss=0.0426, v_num=qyy8]







































































































































Epoch 78:  75%|███████▌  | 360/480 [04:10<01:23,  1.44it/s, loss=0.0436, v_num=qyy8]





































































































Epoch 79:  75%|███████▌  | 360/480 [04:16<01:25,  1.40it/s, loss=0.0472, v_num=qyy8]


























































































































Epoch 80:  75%|███████▌  | 360/480 [04:13<01:24,  1.42it/s, loss=0.0707, v_num=qyy8]


























































































































Epoch 81:  75%|███████▌  | 360/480 [04:12<01:24,  1.43it/s, loss=0.036, v_num=qyy8]



















































































































Epoch 82:  75%|███████▌  | 360/480 [04:17<01:25,  1.40it/s, loss=0.0528, v_num=qyy8]


































































































































Epoch 83:  75%|███████▌  | 360/480 [04:34<01:31,  1.31it/s, loss=0.0361, v_num=qyy8]



























































































































Epoch 84:  75%|███████▌  | 360/480 [04:19<01:26,  1.38it/s, loss=0.0296, v_num=qyy8]






























































































































Epoch 85:  75%|███████▌  | 360/480 [04:15<01:25,  1.41it/s, loss=0.0451, v_num=qyy8]
































































































































Epoch 86:  75%|███████▌  | 360/480 [04:19<01:26,  1.39it/s, loss=0.0494, v_num=qyy8]








































































































Epoch 87:  75%|███████▌  | 360/480 [04:16<01:25,  1.40it/s, loss=0.0417, v_num=qyy8]






















































































































Epoch 88:  75%|███████▌  | 360/480 [04:17<01:25,  1.40it/s, loss=0.0487, v_num=qyy8]












































































































Epoch 89:  75%|███████▌  | 360/480 [04:15<01:25,  1.41it/s, loss=0.0522, v_num=qyy8]



















































































































































Epoch 90:  75%|███████▌  | 360/480 [04:31<01:30,  1.32it/s, loss=0.0428, v_num=qyy8]







































































































































Epoch 91:  75%|███████▌  | 360/480 [04:16<01:25,  1.40it/s, loss=0.0281, v_num=qyy8]
























































































































Epoch 92:  75%|███████▌  | 360/480 [04:39<01:33,  1.29it/s, loss=0.0526, v_num=qyy8]

































































































































Epoch 93:  75%|███████▌  | 360/480 [04:17<01:25,  1.40it/s, loss=0.0375, v_num=qyy8]









































































































Epoch 94:  75%|███████▌  | 360/480 [04:16<01:25,  1.41it/s, loss=0.0397, v_num=qyy8]












































































































Epoch 95:  75%|███████▌  | 360/480 [04:15<01:25,  1.41it/s, loss=0.0419, v_num=qyy8]











































































































Epoch 96:  75%|███████▌  | 360/480 [04:17<01:25,  1.40it/s, loss=0.0485, v_num=qyy8]





























































































































Epoch 97:  75%|███████▌  | 360/480 [04:14<01:24,  1.41it/s, loss=0.044, v_num=qyy8]
















































































































Epoch 98:  75%|███████▌  | 360/480 [04:15<01:25,  1.41it/s, loss=0.0452, v_num=qyy8]



























































































































Epoch 99:  75%|███████▌  | 360/480 [04:24<01:28,  1.36it/s, loss=0.0585, v_num=qyy8]































Validation DataLoader 0:  97%|█████████▋| 116/120 [01:05<00:02,  1.78it/s]

`Trainer.fit` stopped: `max_epochs=100` reached.
2024-08-25 23:54:29.734 | INFO     | __main__:<module>:158 - Testing model



















































































































































100%|██████████| 3848/3848 [04:54<00:00, 13.09it/s]